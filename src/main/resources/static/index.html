<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首页 - 车站售票系统</title>
    <link rel="stylesheet" href="/libs/element-ui/index.css">
    <link href="/css/custom.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <el-container>
            <el-header style="height: 60px;">
                <div style="display: flex; justify-content: space-between; align-items: center; height: 100%;">
                    <h2 style="margin: 0; color: #333;">车站售票系统</h2>
                    <div>
                        <span style="margin-right: 20px;">欢迎，{{ userInfo.realName || userInfo.username }}</span>
                        <el-button type="text" @click="logout">退出登录</el-button>
                    </div>
                </div>
            </el-header>
            <el-container>
                <el-aside width="200px" style="height: calc(100vh - 60px);">
                    <el-menu :default-active="activeMenu" @select="handleMenuSelect" style="height: 100%;">
                        <el-menu-item index="query">
                            <i class="el-icon-search"></i>
                            <span>车次查询</span>
                        </el-menu-item>
                        <el-menu-item index="order">
                            <i class="el-icon-tickets"></i>
                            <span>我的订单</span>
                        </el-menu-item>
                        <el-menu-item v-if="isAdmin" index="admin">
                            <i class="el-icon-setting"></i>
                            <span>后台管理</span>
                        </el-menu-item>
                    </el-menu>
                </el-aside>
                <el-main>
                    <div id="main-content" style="width: 100%; height: 100%;"></div>
                </el-main>
            </el-container>
        </el-container>
    </div>

    <script src="/libs/vue/vue.js"></script>
    <script src="/libs/element-ui/index.js"></script>
    <script src="/libs/axios/axios.min.js"></script>
    <script src="/js/common.js"></script>
    <script>
        // 检查登录状态
        const userStr = sessionStorage.getItem('user');
        if (!userStr) {
            window.location.href = '/static/login/login.html';
        }

        new Vue({
            el: '#app',
            data() {
                const userInfo = JSON.parse(userStr || '{}');
                return {
                    userInfo: userInfo,
                    activeMenu: 'query',
                    isAdmin: userInfo.username === 'admin'
                }
            },
            mounted() {
                // 默认加载车次查询页面
                this.loadPage('query');
            },
            methods: {
                handleMenuSelect(index) {
                    this.activeMenu = index;
                    if (index === 'admin') {
                        // 跳转到后台管理页面
                        window.location.href = '/static/admin/index.html';
                        return;
                    }
                    this.loadPage(index);
                },
                loadPage(page) {
                    const mainContent = document.getElementById('main-content');
                    if (mainContent) {
                        if (page === 'query') {
                            mainContent.innerHTML = '<iframe src="/static/train/query.html" style="width: 100%; height: 100%; border: none;"></iframe>';
                        } else if (page === 'order') {
                            mainContent.innerHTML = '<iframe src="/static/order/list.html" style="width: 100%; height: 100%; border: none;"></iframe>';
                        }
                    }
                },
                logout() {
                    sessionStorage.removeItem('user');
                    window.location.href = '/static/login/login.html';
                }
            }
        });
    </script>
</body>
</html>

